#pragma once
#include <iostream>

#include <GL/glew.h>
#include <SOIL/SOIL.h>
#include <glm/glm.hpp>
#include <glm/gtc/matrix_transform.hpp>

#include "shader.h"

constexpr const char* vertexSource =
        R"(
#version 330 core
layout (location = 0) in vec3 pos;

out vec3 sampleDir;
uniform mat4 proj;
uniform mat4 view;

void main() {
    sampleDir = pos;
    gl_Position = proj * view * vec4(pos, 1.0);
}
)";

constexpr const char* fragmentSource =
        R"(
#version 330 core
out vec4 color;
in vec3 sampleDir;
uniform samplerCube cubemap;

void main() {
    color = texture(cubemap, sampleDir);
}
)";

class Cubemap {
public:
    Cubemap() = default;
    Cubemap(const char* textures[6]);

    void Draw(glm::mat4 proj, glm::mat4 view);

private:
    GLuint vao;
    GLuint vbo;

    GLuint tex;

    Shader shader = Shader(ShaderSource(vertexSource, fragmentSource));
};

constexpr float verts[] = {
        -1.0f,  1.0f, -1.0f,
        -1.0f, -1.0f, -1.0f,
        1.0f, -1.0f, -1.0f,
        1.0f, -1.0f, -1.0f,
        1.0f,  1.0f, -1.0f,
        -1.0f,  1.0f, -1.0f,

        -1.0f, -1.0f,  1.0f,
        -1.0f, -1.0f, -1.0f,
        -1.0f,  1.0f, -1.0f,
        -1.0f,  1.0f, -1.0f,
        -1.0f,  1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f,

        1.0f, -1.0f, -1.0f,
        1.0f, -1.0f,  1.0f,
        1.0f,  1.0f,  1.0f,
        1.0f,  1.0f,  1.0f,
        1.0f,  1.0f, -1.0f,
        1.0f, -1.0f, -1.0f,

        -1.0f, -1.0f,  1.0f,
        -1.0f,  1.0f,  1.0f,
        1.0f,  1.0f,  1.0f,
        1.0f,  1.0f,  1.0f,
        1.0f, -1.0f,  1.0f,
        -1.0f, -1.0f,  1.0f,

        -1.0f,  1.0f, -1.0f,
        1.0f,  1.0f, -1.0f,
        1.0f,  1.0f,  1.0f,
        1.0f,  1.0f,  1.0f,
        -1.0f,  1.0f,  1.0f,
        -1.0f,  1.0f, -1.0f,

        -1.0f, -1.0f, -1.0f,
        -1.0f, -1.0f,  1.0f,
        1.0f, -1.0f, -1.0f,
        1.0f, -1.0f, -1.0f,
        -1.0f, -1.0f,  1.0f,
        1.0f, -1.0f,  1.0f
};